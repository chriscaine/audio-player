<!doctype html>
<html ng-app="app">
<head>
    <title>Socket.IO Position</title>
    <meta name="viewport" value="width=device-width;initial-scale=1" />
    <style type="text/css">
        body, :root { font-size: 10px; background:#e9e9e9;}
        h1, h2{
            font-family:sans-serif;
            font-size:18px;
            margin: 0 0 12px 0;
            color:#555;
        }
       

    </style>
</head>
<body>
   <h1>Audio-Player</h1>
    <div multi-view="main"></div>

    <script src="js/lib/jquery-1.7.1.min.js"></script>
    <script src="js/lib/rx.all.min.js"></script>
    <script src="js/lib/Sortable.js"></script>
    <script src="js/lib/angular-1-1-5.min.js"></script>
    <script src="js/lib/rx.angular.min.js"></script>
    <script>
        angular.module('core', []);
    </script>
    <script src="js/filters/filterArtist.js"></script>
    <script src="js/providers/apiProvider.js"></script>
    <script src="js/providers/routeProvider.js"></script>
    <script src="js/directives/directiveMultiView.js"></script>
    <script src="js/services/serviceTemplate.js"></script>
    <script src="http://localhost:8080/socket.io/socket.io.js"></script>
    <script>
        var app = angular.module('app', ['core', 'rx']);

        app.config(function (routeProvider, apiProvider) {
            apiProvider.setBaseRoute('/api/');
            routeProvider.when('/home', 'main', { templateUrl: '/partials/home.html', controller: 'HomeController' });
            console.log('config');
        });
        app.run(function (route) {
            console.log('run');
        });

        app.factory('CollectionService', function ($q, api) {
            var _collectionApi = api({ endPoint: 'collection', before: null, after: null });
            var _collection;
            _collection = _collectionApi.query({}).then(function (e) {
                if (e.status === 200) {
                    _collection = e.data;
                    return e.data;
                }
            });

            return {
                Get: function () {
                    return $q.all(_collection);
                },
                Update: function () {
                    // ask server to update
                    // receive io response when updated
                }
            }

        });

        app.factory('PlaylistService', function ($q, api) {

            return {
                Get: function (id) { },
                Query: function () { },
                Save: function (id) { }
            }
        });

        app.controller('HomeController', function ($scope, CollectionService) {
            $scope.collection = {};
            CollectionService.Get().then(function (e) {
                $scope.collection = e;
            })
        });

        /*
        var socket = io.connect('http://localhost:8080/');
        var first = true;
        socket.on('data', function (data) {
            console.log(data);
        });
        */


        /* SORTABLES
                       $element.find('ul.sortable').each(function (index, item) {
                    var sortable = new Sortable(item, {
                        group: 'sortable',
                        handle: '.drag-handle',
                        onAdd: function (evt) {
                            if (!evt.item.classList.contains('set-item')) {
                                $(evt.item).remove(); 
                                var item = addListItem(evt.item.getAttribute('data-directive'));
                                $timeout(function () {
                                    $compile(item)($scope);
                                    $(evt.target).append(item);
                                });
                            }
                            $('li').removeClass('sortable-chosen');
                        }
                    });
                    sortables.push(sortable);
                });
                // initialise sortable functionality on Parts List - differs from others
                $element.find('.parts-list ul').each(function (index, item) {
                    var sortable = new Sortable(item, {
                        group: {
                            name: 'sortable',
                            pull: 'clone',
                            put: false
                        }
                    });
                    sortables.push(sortable);
                });


        */

    </script>
</body>
</html>